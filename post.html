<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>帖子详情</title>
    <link rel="stylesheet" href="style.css">
    <script src="app.js"></script>
</head>
<body>
    <div class="container">
        <h1>帖子详情</h1>
        <div id="postDetail"></div>
        <button onclick="window.history.back()">返回</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const postId = new URLSearchParams(window.location.search).get('id');
            const { posts } = getStoredPosts();
            const post = posts.find(p => p.id == postId);
            
            const detailContainer = document.getElementById('postDetail');
            if (!post) {
                detailContainer.innerHTML = '<p>帖子未找到</p>';
                return;
            }

            // 构建详情内容
            let htmlContent = `
                <h2>${post.title}</h2>
                <div class="post-meta-grid">
                    <div><strong>版本：</strong>${post.version}</div>
                    ${post.loader ? `<div><strong>加载器：</strong>${post.loader}</div>` : ''}
                    <div><strong>发布时间：</strong>${post.timestamp}</div>
                    <div><strong>游戏类型：</strong>${post.gameType}</div>
                    <div><strong>联机类型：</strong>${post.serverType}</div>
                    <div><strong>联机方式：</strong>${post.connectionType}</div>
                    <div><strong>存档类型：</strong>${post.saveType}</div>
                    ${post.retentionTime ? `<div><strong>留存时间：</strong>${formatRetentionTime(post.retentionTime)}</div>` : ''}
                </div>
                <div class="post-content-section">
                    <h3>联机详情：</h3>
                    <div class="content-box">${post.content.replace(/\n/g, '<br>')}</div>
                </div>
            `;

            if (post.playstyles) {
                htmlContent += `
                    <div class="playstyle-section">
                        <h3>玩法标签：</h3>
                        <div class="tag-container">
                            ${post.playstyles.split(', ').map(t => `<span class="tag">${t}</span>`).join('')}
                        </div>
                    </div>
                `;
            }

            htmlContent += `
                <div class="contact-section">
                    <h3>📧 联系方式：</h3>
                    <div class="contact-box">${post.contact}</div>
                </div>
            `;

            detailContainer.innerHTML = htmlContent;
        });

        // 辅助函数：转换留存时间为可读格式
        function formatRetentionTime(minutes) {
            const periods = [
                { value: 525600, unit: '年' },  // 1年
                { value: 43200, unit: '月' },    // 1月
                { value: 10080, unit: '周' },    // 7天
                { value: 1440, unit: '天' }      // 1天
            ];
            
            for (let period of periods) {
                if (minutes >= period.value) {
                    return `${Math.floor(minutes/period.value)}${period.unit}`;
                }
            }
            return `${minutes}分钟`;
        }
    </script>
</body>
</html> 